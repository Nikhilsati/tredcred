(this.webpackJsonptred_cred=this.webpackJsonptred_cred||[]).push([[0],{104:function(e,t,n){},108:function(e,t,n){},113:function(e,t){},114:function(e,t){},123:function(e,t,n){"use strict";n.r(t);var a=n(8),c=n(0),r=n.n(c),o=n(14),i=n.n(o),l=(n(104),n(41)),s=n(35),u=n.n(s),d=n(48),j=n(21),b=n(92),p=(n(108),n(165)),f=n(164),h=n(163),O=n(161),v=n(160),x=n(166),m=n(69),g=n.n(m);function D(e){var t=Math.floor(e-25569),n=new Date(1e3*(86400*t)),a=e-Math.floor(e)+1e-7,c=Math.floor(86400*a);return c-=c%60,new Date(n.getFullYear(),n.getMonth(),n.getDate())}var w=function(e){if(e){var t,n=new Set,a=e.length,c=0,r=new Set,o=new Date,i=(e=e.map((function(e){return{invoiceNo:e["Invoice Numbers"],docNo:e["Document Number"],docDate:D(e["Doc. Date"]),netDueDate:D(e["Net due dt"]),amount:e["Amt in loc.cur."],postingDate:D(e["Pstng Date"]),type:e.Type,vendorCode:e["Vendor Code"],vendorName:e["Vendor name"],vendorType:e["Vendor type"]}})).filter((function(e){return e.docDate<=o&&e.netDueDate>o}))).length;return e=e.filter((function(e){return!n.has(e.invoiceNo)&&(n.add(e.invoiceNo),r.add(e.vendorName),c+=e.amount,e.docDate=e.docDate.toString(),e.netDueDate=e.netDueDate.toString(),e.postingDate=e.postingDate.toString(),!0)})),t=r.size,[e,{"Total Entries":a,"Total Valid Entries":i,"Total Duplicates":i-e.length,"Total Amount":c,"Total Vendors":t}]}return null},y=n(159),S=n(154),N=n(156),k=n(158),C=n(125),I=Object(S.a)({root:{minWidth:150,maxWidth:200},title:{fontSize:14}}),T=function(e){var t=e.title,n=e.value,c=I();return Object(a.jsx)(N.a,{className:c.root,children:Object(a.jsxs)(k.a,{children:[Object(a.jsx)(C.a,{className:c.title,color:"textSecondary",gutterBottom:!0,children:t}),Object(a.jsx)(C.a,{variant:"h5",component:"h2",children:n})]})})},A=n(162),F=function(){return Object(a.jsx)("div",{style:{width:"100vw",height:"100vh",backgroundColor:"#00000063",display:"flex",justifyContent:"center",alignItems:"center",position:"fixed",top:0,left:0,zIndex:99999},children:Object(a.jsx)(y.a,{})})},M=n(34),P=n(88);function E(){var e=Object(P.a)(["\n    mutation AddInvoice($invoice: InvoiceInput!) {\n        addInvoice(invoice: $invoice) {\n            invoiceNo\n        }\n    }\n"]);return E=function(){return e},e}var V=Object(M.gql)(E()),B=r.a.forwardRef((function(e,t){return Object(a.jsx)(x.a,Object(l.a)({direction:"up",ref:t},e))})),q=function(e){var t=e.isOpen,n=e.callback,r=e.file,o=Object(c.useState)(null),i=Object(j.a)(o,2),l=i[0],s=i[1],b=Object(c.useState)(null),x=Object(j.a)(b,2),m=x[0],D=x[1],S=Object(c.useState)(!1),N=Object(j.a)(S,2),k=N[0],C=N[1],I=Object(c.useState)(!1),P=Object(j.a)(I,2),E=P[0],q=P[1],z=Object(c.useState)(""),R=Object(j.a)(z,2),U=R[0],_=R[1],Y=Object(M.useMutation)(V),G=Object(j.a)(Y,1)[0];Object(c.useEffect)((function(){r&&(!function(){var e=new FileReader;e.onload=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a,c,r,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.result,a=g.a.read(n,{type:"binary",bookVBA:!0}),c=a.SheetNames[0],r=a.Sheets[c],o=g.a.utils.sheet_to_json(r),e.next=7,s(o);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.readAsBinaryString(r)}(),_(""),q(!1))}),[r]),Object(c.useEffect)((function(){null===m&&(D(w(l)?w(l):null),console.log(m))}),[m,l]);var J=function(){s(null),D(null),n()},L=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(!0),e.next=3,setTimeout((function(){Promise.all(m[0].map((function(e){return G({variables:{invoice:e}})}))).then((function(e){q(!0),C(!1),console.log(e),_("Great All files Uploaded")})).catch((function(e){_("Some Files Failed to Upload, Please Retry"),C(!1)}))}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)(f.a,{open:t,TransitionComponent:B,keepMounted:!0,onClose:J,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description",children:[Object(a.jsx)(v.a,{id:"alert-dialog-slide-title",children:"Statistics"}),k?Object(a.jsx)(F,{}):"",Object(a.jsxs)(O.a,{children:[r&&l&&m?Object(a.jsx)(A.a,{container:!0,spacing:2,children:Object.entries(m[1]).map((function(e){return Object(a.jsx)(A.a,{item:!0,children:Object(a.jsx)(T,{title:e[0],value:e[1]})})}))}):Object(a.jsx)(y.a,{}),U?Object(a.jsx)("p",{children:U}):""]}),Object(a.jsxs)(h.a,{children:[Object(a.jsx)(p.a,{onClick:L,color:"primary",disabled:E,children:E?"Done":"Upload"}),Object(a.jsx)(p.a,{onClick:J,color:"primary",children:"Cancle"})]})]})},z=["xlsx","xlsb","xlsm","xls","csv","wb*","wq*"].map((function(e){return"."+e})).join(",");var R=function(){var e=Object(c.useState)(null),t=Object(j.a)(e,2),n=t[0],r=t[1],o=Object(c.useState)(!1),i=Object(j.a)(o,2),s=i[0],p=i[1],f=function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!t[0]){e.next=5;break}return e.next=3,r(t[0]);case 3:return e.next=5,p(!0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=Object(b.a)({onDrop:f}),O=h.getRootProps,v=h.getInputProps,x=h.isDragActive;return Object(a.jsxs)("div",{className:"app",children:[Object(a.jsxs)("div",Object(l.a)(Object(l.a)({},O({className:"drop-area"})),{},{children:[Object(a.jsx)("input",Object(l.a)({},v({accept:z}))),x?Object(a.jsx)("h1",{children:"Great! You can drop the click now"}):Object(a.jsx)("h1",{children:"Drop or Upload Your Excel File Here!"})]})),Object(a.jsx)(q,{isOpen:s,callback:function(){return p(!1)},file:n})]})},U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,168)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),r(e),o(e)}))},_=new M.ApolloClient({uri:"https://lpjl5f1yn7.execute-api.us-east-1.amazonaws.com/dev/apollo-lambda-dev-graphql/graphql",cache:new M.InMemoryCache});i.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(M.ApolloProvider,{client:_,children:Object(a.jsx)(R,{})})}),document.getElementById("root")),U()},72:function(e,t){}},[[123,1,2]]]);
//# sourceMappingURL=main.9f35f533.chunk.js.map